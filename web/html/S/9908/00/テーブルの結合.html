<h2>テーブルの結合</h2>
関係データベースの最大の魅力は「<strong>データに矛盾が発生しない</strong>」ような設計が可能であることです。<br />その為に、１事実１箇所(1 fact, 1 place)を徹底する必要がありますが、このために重複する部分を複数のテーブルで管理します。<br />このように、データに矛盾を発生さないようにテーブルを分割する作業を「正規化」と呼びます。<br /><br />しかしながら、実際には分割されたテーブルでは不便なケースもあります。<br />テーブルの結合は、このように正規化されたテーブルを適時結合する処理を言います。<br /><br />テーブルの結合には正規化の考えと密接にかかわっていますが、正規化・データベース設計に関しては後ほど説明するため、ここでは分割されたテーブルをある条件を元に、結合させる作業と考えてください。
<p>このページでも簡単な正規化については説明します。</p>
<h2>正規化の必要性</h2>
最初に正規化する必要性について説明します。<br />以下のテーブルをみて下さい。<br />自分がゲットしたポケモンを管理するテーブルです。
<img src="/?S9908/duplicatedTable.gif" alt="重複したテーブル" />
上のテーブルも問題点が分かりますか???<br /><br />上のテーブルでは「図鑑番号」から「名前」「タイプ」を特定できるのにもかかわらず、それを重複して管理している点です。
<img src="/?S9908/duplicatedTableHighlighted.gif" alt="重複したテーブル" />
「ぴぃちゃん(0002)」が進化してライチュウになったとします。<br />以下のSQLを実行してデータベースを更新したとします。
<code class="sql">
	UPDATE my_poke
	SET name = 'ライチュウ'
	WHERE id = 0002;
</code>
以下のテーブルに更新されます。
<img src="/?S9908/conflictedTable.gif" alt="矛盾したテーブル" />
図鑑番号は「25」で「ライチュウ」という矛盾が発生してしまいます。<br />図鑑番号も正しく更新すれば矛盾は防げますが、理論上矛盾が発生しうるという状態そのものが問題であり、設計時にこのような問題を防ぐために正規化(テーブルの適切な分割)を行います。<br /><br />今回は以下のようにテーブルを分割します。
<img src="/?S9908/normalizationOfTable.gif" alt="正規化" />
自分がゲットしたポケモンテーブルとポケモン図鑑テーブルを分離させることで理論上、矛盾が発生しない設計となりました。
<h2>結合の種類</h2>
テーブルの結合の種類は大きく以下の3通りに分類されます。
<ul>
	<li>内部結合</li>
	<li>外部結合</li>
	<li>自然結合</li>
	<li>クロス結合</li>
</ul>
簡単に説明します。
<table>
	<tbody>
		<tr>
			<th>内部結合</th>
			<td>結合対象テーブル両方に存在するデータを抽出。</td>
		</tr>
		<tr>
			<th>外部結合</th>
			<td>結合対象テーブルのうち、基準となるテーブルに存在するデータを抽出。</td>
		</tr>
		<tr>
			<th>クロス結合</th>
			<td>結合対象テーブル両方の全てのパターンを組み合わせる結合です。<br />普段用いることはありません。</td>
		</tr>
	</tbody>
</table>
<div class="separator"></div>
では、自分がゲットしたポケモンを管理するための「my_poke」テーブルを作成します。
<code class="sql">
	CREATE TABLE my_poke(
		id CHAR(4) PRIMARY KEY,
		nickname NVARCHAR(50) NOT NULL,
		number INT NOT NULL,
		level INT CHACK(1 &lt;= level AND level &lt;= 100)
	);
</code>



